import{N as p,k as s,K as i}from"./index-D4giqbAF.js";const h=p("notifications",()=>{const t=s([]),n=s(0),r=s(!1),c=s(null);async function u(){r.value=!0,c.value=null;try{const a=await i.get("/api/notifications");return t.value=a.data.notifications,n.value=a.data.unread_count,t.value}catch(a){return c.value=a.response?.data?.message||"Failed to fetch notifications",[]}finally{r.value=!1}}async function l(a){try{await i.put(`/api/notifications/${a}/read`);const e=t.value.find(o=>o.id===a);return e&&!e.readAt&&(e.readAt=new Date().toISOString(),n.value=Math.max(0,n.value-1)),{success:!0}}catch(e){return{success:!1,error:e.response?.data?.message}}}async function f(){try{return await i.put("/api/notifications/read-all"),t.value.forEach(a=>{a.readAt||(a.readAt=new Date().toISOString())}),n.value=0,{success:!0}}catch(a){return{success:!1,error:a.response?.data?.message}}}async function d(a){try{await i.delete(`/api/notifications/${a}`);const e=t.value.findIndex(o=>o.id===a);return e!==-1&&(t.value[e].readAt||(n.value=Math.max(0,n.value-1)),t.value.splice(e,1)),{success:!0}}catch(e){return{success:!1,error:e.response?.data?.message}}}function v(a){t.value.unshift(a),a.readAt||n.value++}return{notifications:t,unreadCount:n,loading:r,error:c,fetchNotifications:u,markAsRead:l,markAllAsRead:f,deleteNotification:d,addNotification:v}});export{h as m};
