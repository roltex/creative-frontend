import{N as k,k as l}from"./index-D4giqbAF.js";import{o}from"./axios-BfW3-H3C-LYHUv-HN.js";const N=k("news",()=>{const c=l([]),i=l(null),d=l([]),f=l([]),u=l(!1),n=l(null),v=l(!1),t=l({category:"all",tag:"",search:"",featured:!1,date_from:"",date_to:""}),s=l({currentPage:1,totalPages:1,perPage:12,total:0});async function g(e=1){if(u.value)return c.value;u.value=!0,n.value=null;try{const a={page:e,per_page:s.value.perPage};t.value.category!=="all"&&(a.category=t.value.category),t.value.tag&&(a.tag=t.value.tag),t.value.search&&(a.search=t.value.search),t.value.featured&&(a.featured=!0),t.value.date_from&&(a.date_from=t.value.date_from),t.value.date_to&&(a.date_to=t.value.date_to);const r=await o.get("/news",{params:a});if(r.data.success)c.value=Array.isArray(r.data.data)?r.data.data:[],r.data.meta&&(s.value={currentPage:r.data.meta.current_page||1,totalPages:r.data.meta.last_page||1,perPage:r.data.meta.per_page||12,total:r.data.meta.total||0},r.data.meta.categories&&(d.value=r.data.meta.categories),r.data.meta.tags&&(f.value=r.data.meta.tags)),v.value=!0;else throw new Error(r.data.message||"Failed to fetch articles")}catch(a){console.error("Failed to fetch articles:",a),n.value=a.response?.data?.message||a.message||"Failed to fetch articles",c.value=[],v.value=!0}finally{u.value=!1}return c.value}async function h(e){u.value=!0,n.value=null;try{const a=await o.get(`/news/${e}`);if(a.data.success)return i.value=a.data.data,i.value;throw new Error(a.data.message||"Article not found")}catch(a){return console.error("Failed to fetch article:",a),n.value=a.response?.data?.message||a.message||"Failed to fetch article",i.value=null,null}finally{u.value=!1}}async function m(){try{const e=await o.get("/news/categories");if(e.data.success)return d.value=e.data.data,d.value}catch(e){return console.error("Failed to fetch categories:",e),[]}}async function p(){try{const e=await o.get("/news/tags");if(e.data.success)return f.value=e.data.data,f.value}catch(e){return console.error("Failed to fetch tags:",e),[]}}async function y(e=6){try{const a=await o.get("/news/featured",{params:{limit:e}});if(a.data.success)return a.data.data}catch(a){return console.error("Failed to fetch featured articles:",a),[]}}async function w(e=6){try{const a=await o.get("/news/latest",{params:{limit:e}});if(a.data.success)return a.data.data}catch(a){return console.error("Failed to fetch latest articles:",a),[]}}async function _(e=6){try{const a=await o.get("/news/popular",{params:{limit:e}});if(a.data.success)return a.data.data}catch(a){return console.error("Failed to fetch popular articles:",a),[]}}function F(e){t.value={...t.value,...e},s.value.currentPage=1,g(1)}function P(){t.value={category:"all",tag:"",search:"",featured:!1,date_from:"",date_to:""},s.value.currentPage=1,g(1)}async function A(){if(s.value.currentPage<s.value.totalPages&&!u.value){const e=s.value.currentPage+1,a=await g(e);a&&a.length>0&&(c.value=[...c.value,...a])}}return{articles:c,currentArticle:i,categories:d,tags:f,loading:u,error:n,initialized:v,filters:t,pagination:s,fetchArticles:g,fetchArticleBySlug:h,fetchCategories:m,fetchTags:p,fetchFeatured:y,fetchLatest:w,fetchPopular:_,setFilters:F,clearFilters:P,loadMore:A}});export{N as z};
