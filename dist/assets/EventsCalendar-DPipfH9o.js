import{a as C,b as E,o as A,D as j,e as r,f as t,g as f,h as x,t as o,F as k,i as D,v as $,r as _,m as p,q as a,n as N,w as Q,k as X,p as Z,j as ee,l as te}from"./index-C6629Kvt.js";import{u as L}from"./events-CnnrUjWS.js";import{C as se}from"./chevron-left-DKqcH9Cl.js";import{C as ne}from"./chevron-right-DjUiTJjz.js";import{e as V,n as ae,s as T,t as F,c as le,k as oe,h as re,g as ce,a as ie,b as ue}from"./dateFormat-DO1NDqP2.js";import{g as de}from"./imageUrl-TKHrL0N0.js";import{C as z}from"./calendar-CKeEQyRB.js";import{C as ve}from"./clock-WOS_iWFI.js";import{M as he}from"./map-pin-DJr4d4RX.js";import{U as ge}from"./users-B81Pcs_-.js";import"./axios-i4z66gT6.js";import"./notifications-BIGFnnIs.js";import"./createLucideIcon-BddPz1xR.js";function me(e){return V(e,Date.now())}function w(e,i,u){const[h,s]=ae(u?.in,e,i);return+T(h)==+T(s)}function fe(e,i){const u=F(e,i?.in);return u.setDate(1),u.setHours(0,0,0,0),u}function ye(e,i){return F(e,i?.in).getDay()}function xe(e){return+F(e)<Date.now()}function Y(e,i){return w(V(e,e),me(e))}const pe={class:"bg-white rounded-2xl shadow-lg p-6"},_e={class:"flex items-center justify-between mb-6"},we={class:"text-lg font-semibold text-gray-900"},be={class:"grid grid-cols-7 gap-1 mb-2"},ke={class:"grid grid-cols-7 gap-1"},De=["onClick"],$e={class:"text-sm"},Ce={key:0,class:"absolute bottom-1 w-1.5 h-1.5 bg-secondary-500 rounded-full"},Me={key:0,class:"mt-6 pt-4 border-t border-gray-200"},Ee={class:"text-sm text-gray-600"},Fe=C({__name:"EventsCalendar",emits:["date-selected"],setup(e,{emit:i}){const{locale:u}=E(),h=L(),s=_(new Date),n=_(null),y=_([]),v=_(!1),g=i,m=async()=>{v.value=!0;try{const l=s.value.getMonth()+1,c=s.value.getFullYear(),d=await h.fetchCalendar(l,c);y.value=d||[]}catch(l){console.error("Error fetching calendar events:",l),y.value=[]}finally{v.value=!1}};A(()=>{m()}),j(s,()=>{m()});const b=p(()=>u.value==="ka"?["ორ","სამ","ოთხ","ხუთ","პარ","შაბ","კვი"]:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),B=p(()=>le(s.value,"MMMM yyyy",{locale:u.value==="ka"?oe:re})),O=p(()=>{const l=s.value.getFullYear(),c=s.value.getMonth();return new Date(l,c+1,0).getDate()}),R=p(()=>{const l=fe(s.value);return(ye(l)+6)%7}),U=()=>{s.value=new Date(s.value.getFullYear(),s.value.getMonth()-1,1)},q=()=>{s.value=new Date(s.value.getFullYear(),s.value.getMonth()+1,1)},I=l=>{if(!n.value)return!1;const c=new Date(s.value.getFullYear(),s.value.getMonth(),l);return w(c,n.value)},P=l=>{const c=new Date(s.value.getFullYear(),s.value.getMonth(),l);return Y(c)},W=l=>{const c=new Date(s.value.getFullYear(),s.value.getMonth(),l);return xe(c)&&!Y(c)},G=l=>{const c=new Date(s.value.getFullYear(),s.value.getMonth(),l);return(y.value||[]).filter(M=>{if(!M.startAt)return!1;try{const K=new Date(M.startAt);return w(K,c)}catch{return!1}}).length},S=()=>n.value?(y.value||[]).filter(c=>{if(!c.startAt)return!1;try{const d=new Date(c.startAt);return w(d,n.value)}catch{return!1}}).length:0,H=l=>{const c=new Date(s.value.getFullYear(),s.value.getMonth(),l);n.value&&w(c,n.value)?(n.value=null,g("date-selected",null)):(n.value=c,g("date-selected",c))},J=()=>{n.value=null,g("date-selected",null)};return(l,c)=>(a(),r("div",pe,[t("div",_e,[t("button",{onClick:U,class:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors"},[f(x(se),{class:"w-5 h-5 text-gray-600"})]),t("h2",we,o(B.value),1),t("button",{onClick:q,class:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors"},[f(x(ne),{class:"w-5 h-5 text-gray-600"})])]),t("div",be,[(a(!0),r(k,null,D(b.value,d=>(a(),r("div",{key:d,class:"text-center text-xs font-medium text-gray-500 py-2"},o(d),1))),128))]),t("div",ke,[(a(!0),r(k,null,D(R.value,d=>(a(),r("div",{key:`empty-${d}`,class:"aspect-square"}))),128)),(a(!0),r(k,null,D(O.value,d=>(a(),r("button",{key:d,onClick:M=>H(d),class:N(["aspect-square flex flex-col items-center justify-center rounded-lg transition-all relative",I(d)?"bg-secondary-100 text-secondary-700 font-semibold":"hover:bg-gray-50 text-gray-700",P(d)?"ring-2 ring-secondary-500":"",W(d)?"opacity-50":""])},[t("span",$e,o(d),1),G(d)>0?(a(),r("div",Ce)):$("",!0)],10,De))),128))]),S()>0?(a(),r("div",Me,[t("p",Ee,o(S())+" "+o(l.$t("events.eventOnDate")),1)])):$("",!0),n.value?(a(),r("button",{key:1,onClick:J,class:"mt-4 w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors"},o(l.$t("events.clearFilter")),1)):$("",!0)]))}}),Se={class:"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group"},Te={class:"relative h-48 overflow-hidden"},Ye=["src","alt"],Ae={key:1,class:"w-full h-full bg-gradient-to-br from-primary-100 to-primary-200 flex items-center justify-center"},je={class:"absolute top-4 right-4"},Ne={class:"absolute bottom-4 left-4 bg-white rounded-lg px-3 py-2 shadow-lg"},Le={class:"text-2xl font-bold text-gray-900"},Ve={class:"text-xs text-gray-600 uppercase"},ze={class:"p-6"},Be={class:"inline-block px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-xs font-semibold uppercase tracking-wide mb-3"},Oe={class:"text-xl font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-primary-500 transition-colors"},Re={class:"text-gray-600 mb-4 line-clamp-2 text-sm"},Ue={class:"space-y-2 mb-4"},qe={class:"flex items-center text-sm text-gray-500"},Ie={class:"flex items-center text-sm text-gray-500"},Pe={class:"truncate"},We={key:0,class:"flex items-center text-sm text-gray-500"},Ge=C({__name:"EventCard",props:{event:{}},setup(e){const{locale:i}=E(),u=n=>ce(n),h=n=>ie(n,i.value),s=n=>ue(n);return(n,y)=>{const v=Z("RouterLink");return a(),r("article",Se,[t("div",Te,[e.event.image?(a(),r("img",{key:0,src:x(de)(e.event.image),alt:e.event.title[n.$i18n.locale],class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"},null,8,Ye)):(a(),r("div",Ae,[f(x(z),{class:"w-16 h-16 text-primary-500"})])),t("div",je,[t("span",{class:N(["px-3 py-1 rounded-full text-xs font-semibold",e.event.price?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"])},o(e.event.price?`₾${e.event.price}`:n.$t("events.free")),3)]),t("div",Ne,[t("div",Le,o(u(e.event.start_date||e.event.startAt)),1),t("div",Ve,o(h(e.event.start_date||e.event.startAt)),1)])]),t("div",ze,[t("div",Be,o(e.event.type),1),t("h3",Oe,o(e.event.title[n.$i18n.locale]),1),t("p",Re,o(e.event.description[n.$i18n.locale]),1),t("div",Ue,[t("div",qe,[f(x(ve),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t("span",null,o(s(e.event.start_date||e.event.startAt)),1)]),t("div",Ie,[f(x(he),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t("span",Pe,o(e.event.location),1)]),e.event.capacity?(a(),r("div",We,[f(x(ge),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t("span",null,o(e.event.capacity)+" "+o(n.$t("events.seats")),1)])):$("",!0)]),f(v,{to:{name:"event-details",params:{slug:e.event.slug||e.event.id}},class:"block w-full bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-xl font-semibold transition-all duration-200 text-center group-hover:shadow-lg"},{default:Q(()=>[X(o(n.$t("events.register")),1)]),_:1},8,["to"])])])}}}),He={key:0,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},Je={key:1,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},Ke={key:2,class:"text-center py-16 bg-white rounded-2xl shadow-lg"},Qe={class:"text-xl font-semibold text-gray-900 mb-2"},Xe={class:"text-gray-600"},Ze=C({__name:"EventsGrid",props:{filteredDate:{}},setup(e){const i=e,u=L(),h=p(()=>u.events),s=p(()=>u.initialized),n=_([]);j(()=>i.filteredDate,async v=>{if(v){const g=v.getMonth()+1,m=v.getFullYear();try{const b=await u.fetchCalendar(g,m);n.value=b||[]}catch(b){console.error("Error fetching calendar events:",b),n.value=[]}}else n.value=[]},{immediate:!0});const y=p(()=>{const v=i.filteredDate?n.value:h.value||[];return i.filteredDate?v.filter(g=>{if(!g.startAt)return!1;try{const m=new Date(g.startAt);return w(m,i.filteredDate)}catch{return!1}}):v});return A(async()=>{s.value||await u.fetchEvents()}),(v,g)=>(a(),r("div",null,[s.value?y.value?.length>0?(a(),r("div",Je,[(a(!0),r(k,null,D(y.value,m=>(a(),te(Ge,{key:m.id,event:m},null,8,["event"]))),128))])):(a(),r("div",Ke,[f(x(z),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t("h3",Qe,o(v.$t("events.noEvents")),1),t("p",Xe,o(v.$t("events.noEventsDescription")),1)])):(a(),r("div",He,[(a(),r(k,null,D(6,m=>t("div",{key:m,class:"bg-white rounded-2xl shadow-lg"},[...g[0]||(g[0]=[ee('<div class="h-48 skeleton"></div><div class="p-6 space-y-3"><div class="skeleton h-4 w-20"></div><div class="skeleton h-6 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-1/3"></div></div>',2)])])),64))]))]))}}),et={class:"container-fluid py-12"},tt={class:"text-center mb-12"},st={class:"text-4xl lg:text-5xl font-bold text-gray-900 mb-6 font-headline"},nt={class:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed"},at={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},lt={class:"lg:col-span-1"},ot={class:"lg:col-span-3"},_t=C({__name:"EventsCalendar",setup(e){E();const i=_(null),u=h=>{i.value=h};return(h,s)=>(a(),r("div",et,[t("div",tt,[t("h1",st,o(h.$t("events.title")),1),t("p",nt,o(h.$t("events.subtitle")),1)]),t("div",at,[t("div",lt,[f(Fe,{onDateSelected:u})]),t("div",ot,[f(Ze,{filteredDate:i.value},null,8,["filteredDate"])])])]))}});export{_t as default};
