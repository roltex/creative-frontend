import{d as S,r as s}from"./index-Byv4rXtu.js";import{a as n}from"./axios-C60ofk__.js";const z=S("news",()=>{const c=s([]),i=s(null),f=s([]),d=s([]),o=s(!1),u=s(null),v=s(!1),t=s({category:"all",tag:"",search:"",featured:!1,date_from:"",date_to:""}),l=s({currentPage:1,totalPages:1,perPage:12,total:0});async function g(a=1){if(o.value)return c.value;o.value=!0,u.value=null;try{const e={page:a,per_page:l.value.perPage};t.value.category!=="all"&&(e.category=t.value.category),t.value.tag&&(e.tag=t.value.tag),t.value.search&&(e.search=t.value.search),t.value.featured&&(e.featured=!0),t.value.date_from&&(e.date_from=t.value.date_from),t.value.date_to&&(e.date_to=t.value.date_to);const r=await n.get("/news",{params:e});if(r.data.success)c.value=Array.isArray(r.data.data)?r.data.data:[],r.data.meta&&(l.value={currentPage:r.data.meta.current_page||1,totalPages:r.data.meta.last_page||1,perPage:r.data.meta.per_page||12,total:r.data.meta.total||0},r.data.meta.categories&&(f.value=r.data.meta.categories),r.data.meta.tags&&(d.value=r.data.meta.tags)),v.value=!0;else throw new Error(r.data.message||"Failed to fetch articles")}catch(e){console.error("Failed to fetch articles:",e),u.value=e.response?.data?.message||e.message||"Failed to fetch articles",c.value=[],v.value=!0}finally{o.value=!1}return c.value}async function h(a){o.value=!0,u.value=null;try{const e=await n.get(`/news/${a}`);if(e.data.success)return i.value=e.data.data,i.value;throw new Error(e.data.message||"Article not found")}catch(e){return console.error("Failed to fetch article:",e),u.value=e.response?.data?.message||e.message||"Failed to fetch article",i.value=null,null}finally{o.value=!1}}async function p(){try{const a=await n.get("/news/categories");if(a.data.success)return f.value=a.data.data,f.value}catch(a){return console.error("Failed to fetch categories:",a),[]}}async function m(){try{const a=await n.get("/news/tags");if(a.data.success)return d.value=a.data.data,d.value}catch(a){return console.error("Failed to fetch tags:",a),[]}}async function y(a=6){try{const e=await n.get("/news/featured",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch featured articles:",e),[]}}async function w(a=6){try{const e=await n.get("/news/latest",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch latest articles:",e),[]}}async function P(a=6){try{const e=await n.get("/news/popular",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch popular articles:",e),[]}}function _(a){t.value={...t.value,...a},l.value.currentPage=1,g(1)}function F(){t.value={category:"all",tag:"",search:"",featured:!1,date_from:"",date_to:""},l.value.currentPage=1,g(1)}async function A(){if(l.value.currentPage<l.value.totalPages&&!o.value){const a=l.value.currentPage+1,e=await g(a);e&&e.length>0&&(c.value=[...c.value,...e])}}return{articles:c,currentArticle:i,categories:f,tags:d,loading:o,error:u,initialized:v,filters:t,pagination:l,fetchArticles:g,fetchArticleBySlug:h,fetchCategories:p,fetchTags:m,fetchFeatured:y,fetchLatest:w,fetchPopular:P,setFilters:_,clearFilters:F,loadMore:A}});export{z as u};
