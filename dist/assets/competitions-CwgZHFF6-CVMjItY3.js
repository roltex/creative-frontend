import{N as C,k as c}from"./index-D4giqbAF.js";import{o as n}from"./axios-BfW3-H3C-LYHUv-HN.js";const N=C("competitions",()=>{const s=c([]),d=c(null),f=c([]),l=c(!1),u=c(null),m=c(!1),a=c({status:"all",category:"all",search:"",featured:!1,date_from:"",date_to:""}),r=c({currentPage:1,totalPages:1,perPage:12,total:0});async function i(t=1){if(l.value)return s.value;l.value=!0,u.value=null;try{const e={page:t,per_page:r.value.perPage};a.value.status!=="all"&&(e.status=a.value.status),a.value.category!=="all"&&(e.category=a.value.category),a.value.search&&(e.search=a.value.search),a.value.featured&&(e.featured=!0),a.value.date_from&&(e.date_from=a.value.date_from),a.value.date_to&&(e.date_to=a.value.date_to);const o=await n.get("/competitions",{params:e});if(o.data.success)s.value=o.data.data,o.data.meta&&(r.value={currentPage:o.data.meta.current_page,totalPages:o.data.meta.last_page,perPage:o.data.meta.per_page,total:o.data.meta.total},o.data.meta.categories&&(f.value=o.data.meta.categories)),m.value=!0;else throw new Error(o.data.message||"Failed to fetch competitions")}catch(e){console.error("Failed to fetch competitions:",e),u.value=e.response?.data?.message||e.message||"Failed to fetch competitions",s.value=[]}finally{l.value=!1}return s.value}async function g(t){l.value=!0,u.value=null;try{const e=await n.get(`/competitions/${t}`);if(e.data.success)return d.value=e.data.data,d.value;throw new Error(e.data.message||"Competition not found")}catch(e){return console.error("Failed to fetch competition:",e),u.value=e.response?.data?.message||e.message||"Failed to fetch competition",d.value=null,null}finally{l.value=!1}}async function p(){try{const t=await n.get("/competitions/categories");if(t.data.success)return f.value=t.data.data,f.value}catch(t){return console.error("Failed to fetch categories:",t),[]}}async function v(t=12){try{const e=await n.get("/competitions/current",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch current competitions:",e),[]}}async function h(t=12){try{const e=await n.get("/competitions/completed",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch completed competitions:",e),[]}}async function y(t=12){try{const e=await n.get("/competitions/upcoming",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch upcoming competitions:",e),[]}}async function _(t=6){try{const e=await n.get("/competitions/featured",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch featured competitions:",e),[]}}function F(t){a.value={...a.value,...t},r.value.currentPage=1,i(1)}function w(){a.value={status:"all",category:"all",search:"",featured:!1,date_from:"",date_to:""},r.value.currentPage=1,i(1)}async function P(){if(r.value.currentPage<r.value.totalPages&&!l.value){const t=r.value.currentPage+1,e=await i(t);e&&e.length>0&&(s.value=[...s.value,...e])}}return m.value||(i(),p()),{competitions:s,currentCompetition:d,categories:f,loading:l,error:u,initialized:m,filters:a,pagination:r,fetchCompetitions:i,fetchCompetitionBySlug:g,fetchCategories:p,fetchCurrent:v,fetchCompleted:h,fetchUpcoming:y,fetchFeatured:_,setFilters:F,clearFilters:w,loadMore:P}});export{N as E};
