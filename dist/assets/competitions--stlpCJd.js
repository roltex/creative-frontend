import{d as C,r as s}from"./index-DsFNXLy9.js";import{a as i}from"./axios-DmEz51qs.js";const E=C("competitions",()=>{const c=s([]),f=s(null),d=s([]),n=s(!1),l=s(null),m=s(!1),a=s({status:"all",category:"all",search:"",featured:!1,date_from:"",date_to:""}),o=s({currentPage:1,totalPages:1,perPage:12,total:0});async function u(t=1){if(n.value)return c.value;n.value=!0,l.value=null;try{const e={page:t,per_page:o.value.perPage};a.value.status!=="all"&&(e.status=a.value.status),a.value.category!=="all"&&(e.category=a.value.category),a.value.search&&(e.search=a.value.search),a.value.featured&&(e.featured=!0),a.value.date_from&&(e.date_from=a.value.date_from),a.value.date_to&&(e.date_to=a.value.date_to);const r=await i.get("/competitions",{params:e});if(r.data.success)c.value=r.data.data,r.data.meta&&(o.value={currentPage:r.data.meta.current_page,totalPages:r.data.meta.last_page,perPage:r.data.meta.per_page,total:r.data.meta.total},r.data.meta.categories&&(d.value=r.data.meta.categories)),m.value=!0;else throw new Error(r.data.message||"Failed to fetch competitions")}catch(e){console.error("Failed to fetch competitions:",e),l.value=e.response?.data?.message||e.message||"Failed to fetch competitions",c.value=[]}finally{n.value=!1}return c.value}async function g(t){n.value=!0,l.value=null;try{const e=await i.get(`/competitions/${t}`);if(e.data.success)return f.value=e.data.data,f.value;throw new Error(e.data.message||"Competition not found")}catch(e){return console.error("Failed to fetch competition:",e),l.value=e.response?.data?.message||e.message||"Failed to fetch competition",f.value=null,null}finally{n.value=!1}}async function p(){try{const t=await i.get("/competitions/categories");if(t.data.success)return d.value=t.data.data,d.value}catch(t){return console.error("Failed to fetch categories:",t),[]}}async function v(t=12){try{const e=await i.get("/competitions/current",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch current competitions:",e),[]}}async function h(t=12){try{const e=await i.get("/competitions/completed",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch completed competitions:",e),[]}}async function y(t=12){try{const e=await i.get("/competitions/upcoming",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch upcoming competitions:",e),[]}}async function _(t=6){try{const e=await i.get("/competitions/featured",{params:{limit:t}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch featured competitions:",e),[]}}function F(t){a.value={...a.value,...t},o.value.currentPage=1,u(1)}function P(){a.value={status:"all",category:"all",search:"",featured:!1,date_from:"",date_to:""},o.value.currentPage=1,u(1)}async function w(){if(o.value.currentPage<o.value.totalPages&&!n.value){const t=o.value.currentPage+1,e=await u(t);e&&e.length>0&&(c.value=[...c.value,...e])}}return m.value||(u(),p()),{competitions:c,currentCompetition:f,categories:d,loading:n,error:l,initialized:m,filters:a,pagination:o,fetchCompetitions:u,fetchCompetitionBySlug:g,fetchCategories:p,fetchCurrent:v,fetchCompleted:h,fetchUpcoming:y,fetchFeatured:_,setFilters:F,clearFilters:P,loadMore:w}});export{E as u};
