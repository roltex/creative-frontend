import{d as p,r,U as i}from"./index-pPlZ3vbs.js";const m=p("notifications",()=>{const t=r([]),s=r(0),o=r(!1),c=r(null);async function u(){o.value=!0,c.value=null;try{const e=await i.get("/api/notifications");return t.value=e.data.notifications,s.value=e.data.unread_count,t.value}catch(e){return c.value=e.response?.data?.message||"Failed to fetch notifications",[]}finally{o.value=!1}}async function l(e){try{await i.put(`/api/notifications/${e}/read`);const a=t.value.find(n=>n.id===e);return a&&!a.readAt&&(a.readAt=new Date().toISOString(),s.value=Math.max(0,s.value-1)),{success:!0}}catch(a){return{success:!1,error:a.response?.data?.message}}}async function f(){try{return await i.put("/api/notifications/read-all"),t.value.forEach(e=>{e.readAt||(e.readAt=new Date().toISOString())}),s.value=0,{success:!0}}catch(e){return{success:!1,error:e.response?.data?.message}}}async function d(e){try{await i.delete(`/api/notifications/${e}`);const a=t.value.findIndex(n=>n.id===e);return a!==-1&&(t.value[a].readAt||(s.value=Math.max(0,s.value-1)),t.value.splice(a,1)),{success:!0}}catch(a){return{success:!1,error:a.response?.data?.message}}}function v(e){t.value.unshift(e),e.readAt||s.value++}return{notifications:t,unreadCount:s,loading:o,error:c,fetchNotifications:u,markAsRead:l,markAllAsRead:f,deleteNotification:d,addNotification:v}});export{m as u};
