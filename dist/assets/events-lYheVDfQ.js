import{d as E,r as u}from"./index-Byv4rXtu.js";import{a as c}from"./axios-C60ofk__.js";const $=E("events",()=>{const o=u([]),i=u(null),s=u(!1),n=u(null),d=u(!1),r=u({status:"all",date_from:"",date_to:"",search:"",featured:!1}),l=u({currentPage:1,totalPages:1,perPage:12,total:0});async function v(a=1){if(s.value)return o.value;s.value=!0,n.value=null;try{const e={page:a,per_page:l.value.perPage};r.value.status!=="all"&&(e.status=r.value.status),r.value.search&&(e.search=r.value.search),r.value.featured&&(e.featured=!0),r.value.date_from&&(e.date_from=r.value.date_from),r.value.date_to&&(e.date_to=r.value.date_to);const t=await c.get("/events",{params:e});if(t.data.success)o.value=t.data.data,t.data.meta&&(l.value={currentPage:t.data.meta.current_page,totalPages:t.data.meta.last_page,perPage:t.data.meta.per_page,total:t.data.meta.total}),d.value=!0;else throw new Error(t.data.message||"Failed to fetch events")}catch(e){console.error("Failed to fetch events:",e),n.value=e.response?.data?.message||e.message||"Failed to fetch events",o.value=[]}finally{s.value=!1}return o.value}async function g(a){s.value=!0,n.value=null;try{const e=await c.get(`/events/${a}`);if(e.data.success)return i.value=e.data.data,i.value;throw new Error(e.data.message||"Event not found")}catch(e){return console.error("Failed to fetch event:",e),n.value=e.response?.data?.message||e.message||"Failed to fetch event",i.value=null,null}finally{s.value=!1}}async function p(a=6){try{const e=await c.get("/events/upcoming",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch upcoming events:",e),[]}}async function h(a=6){try{const e=await c.get("/events/ongoing",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch ongoing events:",e),[]}}async function m(a=6){try{const e=await c.get("/events/featured",{params:{limit:a}});if(e.data.success)return e.data.data}catch(e){return console.error("Failed to fetch featured events:",e),[]}}async function y(a,e){try{const t={};a&&(t.month=a),e&&(t.year=e);const f=await c.get("/events/calendar",{params:t});return f.data.success?Array.isArray(f.data.data)?f.data.data:[]:[]}catch(t){return console.error("Failed to fetch calendar events:",t),[]}}async function F(a,e){s.value=!0,n.value=null;try{return{success:!0,registration:(await c.post(`/events/${a}/register`,e)).data}}catch(t){return n.value=t.response?.data?.message||"Failed to register for event",{success:!1,error:n.value}}finally{s.value=!1}}function _(a){r.value={...r.value,...a},l.value.currentPage=1,v(1)}function P(){r.value={status:"all",date_from:"",date_to:"",search:"",featured:!1},l.value.currentPage=1,v(1)}async function w(){if(l.value.currentPage<l.value.totalPages&&!s.value){const a=l.value.currentPage+1,e=await v(a);e&&e.length>0&&(o.value=[...o.value,...e])}}return{events:o,currentEvent:i,loading:s,error:n,initialized:d,filters:r,pagination:l,fetchEvents:v,fetchEventBySlug:g,fetchUpcoming:p,fetchOngoing:h,fetchFeatured:m,fetchCalendar:y,registerForEvent:F,setFilters:_,clearFilters:P,loadMore:w}});export{$ as u};
